!function(){function o(){let o=0;const e=new MutationObserver(()=>{const e=document.querySelector("button.qrcode_refresh_btn");if(e){if(Date.now()-o<3e3)return;console.log('[äºŒç»´ç ç›‘å¬] ðŸ”„ æ£€æµ‹åˆ°"åˆ·æ–°äºŒç»´ç "æŒ‰é’®ï¼Œå‡†å¤‡è‡ªåŠ¨ç‚¹å‡»'),setTimeout(()=>{try{e.click(),o=Date.now(),console.log('[äºŒç»´ç ç›‘å¬] âœ… å·²è‡ªåŠ¨ç‚¹å‡»"åˆ·æ–°äºŒç»´ç "æŒ‰é’®')}catch(o){console.error("[äºŒç»´ç ç›‘å¬] âŒ ç‚¹å‡»æŒ‰é’®å¤±è´¥:",o)}},100)}});document.body&&(e.observe(document.body,{childList:!0,subtree:!0}),console.log('[äºŒç»´ç ç›‘å¬] ðŸ” "åˆ·æ–°äºŒç»´ç "æŒ‰é’®ç›‘å¬å·²å¯åŠ¨'))}function e(){let o=null,e=!1;const n=new MutationObserver(n=>{const t=document.querySelector('img.code_img[src^="data:image"]');var c;t&&t.src&&!e&&(e=!0,console.log("[äºŒç»´ç ç›‘å¬] æ£€æµ‹åˆ°äºŒç»´ç å›¾ç‰‡å…ƒç´ ï¼Œå¼€å§‹è§£æž..."),(c=t.src,new Promise((o,e)=>{const n=new Image;n.crossOrigin="Anonymous",n.onload=function(){try{const t=document.createElement("canvas"),c=t.getContext("2d");t.width=n.width,t.height=n.height,c.drawImage(n,0,0);const l=c.getImageData(0,0,t.width,t.height),i=jsQR(l.data,l.width,l.height);i&&i.data?(console.log("[äºŒç»´ç ç›‘å¬] è§£æžæˆåŠŸ:",i.data),o(i.data)):(console.warn("[äºŒç»´ç ç›‘å¬] æœªèƒ½è§£æžäºŒç»´ç "),e(new Error("æœªèƒ½è§£æžäºŒç»´ç ")))}catch(o){console.error("[äºŒç»´ç ç›‘å¬] è§£æžé”™è¯¯:",o),e(o)}},n.onerror=o=>{console.error("[äºŒç»´ç ç›‘å¬] å›¾ç‰‡åŠ è½½å¤±è´¥:",o),e(o)},n.src=c})).then(n=>{const t=function(o){const e=document.createElement("textarea");return e.innerHTML=o,e.value}(n);console.log("[äºŒç»´ç ç›‘å¬] äºŒç»´ç åŽŸå§‹å†…å®¹:",n),console.log("[äºŒç»´ç ç›‘å¬] äºŒç»´ç è§£ç åŽ:",t);const c=function(o){try{const e={loginId:null,action:null,loginType:null},n=o.match(/[?&]loginId=([^&]+)/),t=o.match(/[?&]action=([^&]+)/),c=o.match(/[?&]loginType=([^&]+)/);if(n&&(e.loginId=n[1]),t&&(e.action=t[1]),c&&(e.loginType=c[1]),e.loginId&&e.action&&e.loginType)return e;const l=new URL(o);if(e.loginId||(e.loginId=l.searchParams.get("loginId")||l.searchParams.get("login_id")||l.searchParams.get("id")),e.action||(e.action=l.searchParams.get("action")),e.loginType||(e.loginType=l.searchParams.get("loginType")),l.hash&&l.hash.includes("?")){const o=l.hash.split("?")[1],n=new URLSearchParams(o);e.loginId||(e.loginId=n.get("loginId")||n.get("login_id")||n.get("id")),e.action||(e.action=n.get("action")),e.loginType||(e.loginType=n.get("loginType"))}if(!e.loginId){const n=o.match(/\/([a-zA-Z0-9_-]+)\/?$/);n&&(e.loginId=n[1])}return e.loginId?(console.log("[äºŒç»´ç ç›‘å¬] æå–çš„å‚æ•°:",e),e):(console.warn("[äºŒç»´ç ç›‘å¬] æœªèƒ½ä»Ž URL æå– loginId:",o),null)}catch(o){return console.error("[äºŒç»´ç ç›‘å¬] URL è§£æžå¤±è´¥:",o),null}}(t);c&&c.loginId?c.loginId!==o?(console.log("[äºŒç»´ç ç›‘å¬] ðŸ†• æ£€æµ‹åˆ°æ–°äºŒç»´ç ï¼Œå‚æ•°:",c),o=c.loginId,window.postMessage({type:"SAVE_QRCODE",payload:{qrcodeUrl:t,loginId:c.loginId,action:c.action||"face_login",loginType:c.loginType||"PlugFaceDoc"}},"*")):console.log("[äºŒç»´ç ç›‘å¬] ç›¸åŒçš„ loginIdï¼Œè·³è¿‡:",c.loginId):console.warn("[äºŒç»´ç ç›‘å¬] æœªèƒ½ä»Ž URL æå–ç™»å½•å‚æ•°:",t),e=!1}).catch(o=>{console.error("[äºŒç»´ç ç›‘å¬] äºŒç»´ç è§£æžå¤±è´¥:",o),e=!1}))});document.body?(n.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["src"]}),console.log("[äºŒç»´ç ç›‘å¬] DOM ç›‘å¬å·²å¯åŠ¨")):console.error("[äºŒç»´ç ç›‘å¬] document.body ä¸å­˜åœ¨ï¼Œç­‰å¾… DOM åŠ è½½")}console.log("[äºŒç»´ç ç›‘å¬] å¼€å§‹ç›‘å¬äºŒç»´ç ç”Ÿæˆ"),document.body?(e(),o()):"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{e(),o()}):setTimeout(()=>{e(),o()},100)}();